geom_histogram() +
facet_wrap(~sex, ncol = 1) +
rotate_x()
ggplot(adult, aes(x = relationship)) +
geom_histogram() +
facet_wrap(~sex, ncol = 1) +
rotate_x()
ggplot(adult, aes(x = marital_status)) +
geom_histogram() +
facet_wrap(~sex, ncol = 1) +
rotate_x()
ggplot(adult, aes(x = marital_status)) +
geom_histogram() +
facet_wrap(~sex, ncol = 1) +
rotate_x()
ggplot(adult, aes(x = relationship)) +
geom_histogram() +
facet_wrap(~sex, ncol = 1) +
rotate_x()
ggplot(adult, aes(x = relationship, fill = sex)) +
geom_histogram() +
rotate_x()
ggplot(adult, aes(x = relationship, fill = sex)) +
geom_histogram(postiion = 'dodge') +
rotate_x()
ggplot(adult, aes(x = relationship, fill = sex)) +
geom_histogram(position = 'dodge') +
rotate_x()
ggplot(adult, aes(x = marital_status)) +
geom_histogram() +
facet_wrap(~sex, ncol = 1) +
rotate_x()
ggplot(adult, aes(x = marital_status, fill = sex)) +
geom_histogram() +
rotate_x()
ggplot(adult, aes(x = marital_status, fill = sex)) +
geom_histogram(position = 'dodge') +
rotate_x()
ggplot(data = adult, aes(x = age, fill = marital_status)) +
geom_histogram(binwidth = 1)
ggplot(data = adult, aes(x = age, fill = marital_status)) +
geom_boxplot(binwidth = 1)
ggplot(data = adult, aes(x = age, y = marital_status)) +
ggplot(data = adult, aes(x = age, fill = marital_status)) +
geom_histogram(binwidth = 1)
ggplot(data = adult, aes(x = age, fill = marital_status)) +
geom_histogram(binwidth = 1)
ggplot(data = adult, aes(x = relationship ,y = age)) +
geom_boxplot()
ggplot(data = adult, aes(x = relationship, y = age, fill = relationship)) +
geom_boxplot()
ggplot(data = adult, aes(x = marital_status, y = age, fill = marital_status)) +
geom_boxplot()
ggplot(data = adult, aes(x = marital_status, y = age, fill = marital_status)) +
geom_histogram()
ggplot(data = adult, aes(x = marital_status, y = age, fill = marital_status)) +
geom_boxplot()
ggplot(data = adult, aes(x = marital_status, y = age, fill = marital_status)) +
geom_boxplot() +
rotate_x()
ggplot(data = adult, aes(x = marital_status, y = age, fill = marital_status)) +
geom_boxplot() +
theme(legend.position = 'none') +
rotate_x()
ggplot(data = adult, aes(x = age, fill = relationship)) +
geom_histogram(binwidth = 1)
ggplot(data = adult, aes(x = relationship, y = age, fill = relationship)) +
geom_boxplot() +
theme(legend.position = 'none') +
rotate_x()
'Own-child' is the youngest, 'Husband' is the oldest, 'Wife' is a bit younger. As with marital_status, no surprises.<br />
ggplot(data = adult, aes(x = occupation, fill = occupation)) +
geom_histogram() +
theme(legend.position = 'none') +
facet_wrap(~income, ncol = 1) +
rotate_x()
nrow(subset(adult, income == 'high' & (occupation == 'Prof-speciality' | occupation == 'Exec-managerial'))/
nrow(subset(adult, income == 'high'))
sd
nrow(subset(adult, income == 'high' & (occupation == 'Prof-speciality' | occupation == 'Exec-managerial')))/
nrow(subset(adult, income == 'high'))
nrow(subset(adult, income == 'high' & (occupation == 'Prof-specialty' | occupation == 'Exec-managerial')))/
nrow(subset(adult, income == 'high'))
nrow(subset(adult, income == 'high' & (occupation == 'Craft-repair' | occupation == 'Sales')))/
nrow(subset(adult, income == 'high'))
nrow(subset(adult, income == 'high' & (occupation == 'Craft-repair1' | occupation == 'Sales')))/
nrow(subset(adult, income == 'high'))
nrow(subset(adult, income == 'high' & (occupation == 'Craft-repair1' | occupation == 'Sales1')))/
nrow(subset(adult, income == 'high'))
ggplot(data = adult, aes(x = race, fill = sex)) +
geom_histogram(position = 'dodge') +
scale_y_log10(breaks = c(10,100,1000,10000))
.26^.5
.3^2
ggplot(cormat_melt, aes(variable,  variable2)) +
geom_tile(aes(fill = value)) +
geom_text(aes(fill = cormat_melt$value, label = cormat_melt$text), size = 3) +
scale_fill_gradient(low = "white", high = "red") +
ggtitle("Correlation matrix\n* - Cramer's V, ** - Eta(ANOVA), *** - Pearson's R") +
rotate_x()
nrow(subset(adult, native_country == 'United-States'))
nrow(subset(adult, native_country == 'United-States' & race == 'White'))/nrow(subset(adult,race == 'White'))
nrow(subset(adult, native_country == 'United-States' & race == 'White'))
/nrow(subset(adult,race == 'White'))
nrow(subset(adult, native_country == 'United-States' & race == 'White'))/
nrow(subset(adult,race == 'White'))
nrow(subset(adult, native_country == 'United-States' & race == 'White'))/
nrow(subset(adult,native_country == 'United-States'))
#HSR for every combination of age and sex.
adult_by_age_sex<- adult %>%
group_by(age, sex) %>%
summarise(hsr = sum(income == 'high')/n(),
n = n()) %>%
arrange(age, sex)
ggplot(adult_by_age_sex, aes(x = age, y = hsr, color = sex)) +
geom_line(size = 1) +
geom_smooth() +
scale_x_continuous(breaks = seq(10,90,10)) +
ylim(c(0,NA))
ggplot(adult_by_age_education, aes(x = age, y = hsr, color = education)) +
geom_smooth(se = FALSE, size = 1) +
ylim(0,NA)
ggplot(data = adult, aes(x = education, y = age, fill = income)) +
geom_boxplot() +
scale_y_continuous(breaks = seq(0,100,10)) +
rotate_x()
ggplot(data = adult, aes(x = relationship, y = age, fill = sex)) +
geom_boxplot()
ggplot(data = adult, aes(x = age, y = hours_per_week, color = sex)) +
geom_jitter(alpha = 0.2) +
fix_alpha +
scale_y_continuous(breaks = seq(0,100,10)) +
geom_smooth(alpha = 1, size = 2, se = FALSE)
ggplot(data = adult, aes(x = age, fill = relationship)) +
geom_histogram(binwidth = 1) +
facet_wrap(~sex, ncol = 1)
ggplot(data = adult, aes(x = age)) +
geom_histogram(binwidth = 1) +
facet_wrap(~sex + relationship, ncol = 6)
ggplot(data = adult, aes(x = age, fill = sex)) +
geom_histogram(binwidth = 1, position = 'dodge') +
facet_wrap(~income, ncol = 1) +
xlab('Age, years') +
ylab('Number of Respondents') +
ggtitle('Histogram of Ages, by Sex and relationship')
ggplot(data = adult_by[['hours_per_week']], aes(x = hours_per_week, y = hsr)) +
geom_smooth() +
geom_line() +
xlab('Hours per week working') +
ylab('High salary ratio (frequency of high-income people)') +
ggtitle('Relation of income to working hours per week')
ggplot(data = occupation_by_sex, aes(x = occupation, y = female_ratio, fill = n)) +
geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
geom_abline(slope = 0, intercept = nrow(subset(adult,sex=='Female'))/nrow(adult), size = 2, color = 'red') +
rotate_x() +
ylab('Percentage of females in occupation') +
xlab('Occupation') +
ggtitle('Occupations by gender\n\ncolor - size of the group\nline - average level')
?scale_color_brewer
ggplot(data = occupation_by_sex, aes(x = occupation, y = female_ratio, fill = n)) +
geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
scale_color_brewer(palette = 'Purples')
geom_abline(slope = 0, intercept = nrow(subset(adult,sex=='Female'))/nrow(adult), size = 2, color = 'red') +
rotate_x() +
ylab('Percentage of females in occupation') +
xlab('Occupation') +
ggtitle('Occupations by gender\n\ncolor - size of the group\nline - average level')
ggplot(data = occupation_by_sex, aes(x = occupation, y = female_ratio, fill = n)) +
geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
scale_color_brewer(palette = 'Purples') +
geom_abline(slope = 0, intercept = nrow(subset(adult,sex=='Female'))/nrow(adult), size = 2, color = 'red') +
rotate_x() +
ylab('Percentage of females in occupation') +
xlab('Occupation') +
ggtitle('Occupations by gender\n\ncolor - size of the group\nline - average level')
ggplot(data = occupation_by_sex, aes(x = occupation, y = female_ratio, fill = n)) +
geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
scale_color_brewer(palette = 'Purples') +
geom_abline(slope = 0, intercept = nrow(subset(adult,sex=='Female'))/nrow(adult), size = 2, color = 'red') +
rotate_x() +
ylab('Percentage of females in occupation') +
xlab('Occupation') +
ggtitle('Occupations by gender\n\ncolor - size of the group\nline - average level')
?scale_color_brewer
ggplot(data = occupation_by_sex, aes(x = occupation, y = female_ratio, fill = n)) +
geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
scale_fill_brewer(palette = 'Purples') +
geom_abline(slope = 0, intercept = nrow(subset(adult,sex=='Female'))/nrow(adult), size = 2, color = 'red') +
rotate_x() +
ylab('Percentage of females in occupation') +
xlab('Occupation') +
ggtitle('Occupations by gender\n\ncolor - size of the group\nline - average level')
ggplot(data = occupation_by_sex, aes(x = occupation, y = female_ratio, fill = n)) +
geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
scale_color_brewer(palette = 'Purples') +
geom_abline(slope = 0, intercept = nrow(subset(adult,sex=='Female'))/nrow(adult), size = 2, color = 'red') +
rotate_x() +
ylab('Percentage of females in occupation') +
xlab('Occupation') +
ggtitle('Occupations by gender\n\ncolor - size of the group\nline - average level')
ggplot(data = occupation_by_sex, aes(x = occupation, y = female_ratio, fill = n)) +
geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
scale_color_brewer(palette = 'PRGn') +
geom_abline(slope = 0, intercept = nrow(subset(adult,sex=='Female'))/nrow(adult), size = 2, color = 'red') +
rotate_x() +
ylab('Percentage of females in occupation') +
xlab('Occupation') +
ggtitle('Occupations by gender\n\ncolor - size of the group\nline - average level')
ggplot(data = occupation_by_sex, aes(x = occupation, y = female_ratio, fill = n)) +
geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
scale_color_brewer(palette = 'PRGnsd') +
geom_abline(slope = 0, intercept = nrow(subset(adult,sex=='Female'))/nrow(adult), size = 2, color = 'red') +
rotate_x() +
ylab('Percentage of females in occupation') +
xlab('Occupation') +
ggtitle('Occupations by gender\n\ncolor - size of the group\nline - average level')
ggplot(data = occupation_by_sex, aes(x = occupation, y = female_ratio, fill = n)) +
geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
scale_fill_brewer(palette = 'PRGn') +
geom_abline(slope = 0, intercept = nrow(subset(adult,sex=='Female'))/nrow(adult), size = 2, color = 'red') +
rotate_x() +
ylab('Percentage of females in occupation') +
xlab('Occupation') +
ggtitle('Occupations by gender\n\ncolor - size of the group\nline - average level')
?brewer_pal
??brewer
ggplot(data = occupation_by_sex, aes(x = occupation, y = female_ratio, fill = n)) +
geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
scale_fill_distiller(palette = 'PRGn') +
geom_abline(slope = 0, intercept = nrow(subset(adult,sex=='Female'))/nrow(adult), size = 2, color = 'red') +
rotate_x() +
ylab('Percentage of females in occupation') +
xlab('Occupation') +
ggtitle('Occupations by gender\n\ncolor - size of the group\nline - average level')
ggplot(data = occupation_by_sex, aes(x = occupation, y = female_ratio, fill = n)) +
geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
scale_fill_distiller(palette = 'Reds') +
geom_abline(slope = 0, intercept = nrow(subset(adult,sex=='Female'))/nrow(adult), size = 2, color = 'red') +
rotate_x() +
ylab('Percentage of females in occupation') +
xlab('Occupation') +
ggtitle('Occupations by gender\n\ncolor - size of the group\nline - average level')
ggplot(data = occupation_by_sex, aes(x = occupation, y = female_ratio, fill = -n)) +
geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
scale_fill_distiller(palette = 'Reds') +
geom_abline(slope = 0, intercept = nrow(subset(adult,sex=='Female'))/nrow(adult), size = 2, color = 'red') +
rotate_x() +
ylab('Percentage of females in occupation') +
xlab('Occupation') +
ggtitle('Occupations by gender\n\ncolor - size of the group\nline - average level')
ggplot(data = occupation_by_sex, aes(x = occupation, y = female_ratio, fill = n)) +
geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
scale_fill_distiller(palette = 'Reds') +
geom_abline(slope = 0, intercept = nrow(subset(adult,sex=='Female'))/nrow(adult), size = 2, color = 'red') +
rotate_x() +
ylab('Percentage of females in occupation') +
xlab('Occupation') +
ggtitle('Occupations by gender\n\ncolor - size of the group\nline - average level')
?scale_color_brewer
ggplot(data = occupation_by_sex, aes(x = occupation, y = female_ratio, fill = n)) +
geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
scale_fill_distiller(palette = 'Oranges') +
geom_abline(slope = 0, intercept = nrow(subset(adult,sex=='Female'))/nrow(adult), size = 2, color = 'red') +
rotate_x() +
ylab('Percentage of females in occupation') +
xlab('Occupation') +
ggtitle('Occupations by gender\n\ncolor - size of the group\nline - average level')
ggplot(data = occupation_by_sex, aes(x = occupation, y = female_ratio, fill = n)) +
geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
scale_fill_distiller(palette = 'Oranges') +
geom_abline(slope = 0, intercept = nrow(subset(adult,sex=='Female'))/nrow(adult), size = 2, color = 'red') +
rotate_x() +
ylab('Percentage of females in occupation') +
xlab('Occupation') +
ggtitle('Occupations by gender\n\ncolor - size of the group(darker = more)\nline - average level')
ggplot(data = occupation_by_sex, aes(x = occupation, y = female_ratio, fill = n)) +
geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
scale_fill_distiller(palette = 'Oranges') +
geom_abline(slope = 0, intercept = nrow(subset(adult,sex=='Female'))/nrow(adult), size = 2, color = 'red') +
rotate_x() +
ylab('Percentage of females in occupation') +
xlab('Occupation') +
ggtitle('Occupations by gender\n\ncolor - size of the group (darker = more)\nline - average level')
ggplot(data = occupation_by_sex, aes(x = occupation, y = female_ratio, fill = n)) +
geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
scale_fill_distiller(palette = 'Oranges') +
geom_abline(slope = 0, intercept = nrow(subset(adult,sex=='Female'))/nrow(adult), size = 2, color = 'black') +
rotate_x() +
ylab('Percentage of females in occupation') +
xlab('Occupation') +
ggtitle('Occupations by gender\n\ncolor - size of the group (darker = more)\nline - average level')
ggplot(data = occupation_by_sex, aes(x = occupation, y = female_ratio, fill = n)) +
geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
scale_fill_distiller(palette = 'Oranges') +
geom_abline(slope = 0, intercept = nrow(subset(adult,sex=='Female'))/nrow(adult), size = 1, color = 'black') +
rotate_x() +
ylab('Percentage of females in occupation') +
xlab('Occupation') +
ggtitle('Occupations by gender\n\ncolor - size of the group (darker = more)\nline - average level')
ggplot(adult_by_age_education, aes(x = age, y = hsr, color = education)) +
geom_smooth(se = FALSE, size = 1) +
ylim(0,NA)
ggplot(adult_by_age_education, aes(x = age, y = hsr)) +
geom_smooth(se = FALSE, size = 1) +
ylim(0,NA)
ggplot(adult_by_age_education, aes(x = age, y = hsr)) +
geom_line()
geom_smooth(se = FALSE, size = 1) +
ylim(0,NA)
ggplot(adult_by_age_education, aes(x = age, y = hsr)) +
geom_line() +
geom_smooth(se = FALSE, size = 1) +
ylim(0,NA)
ggplot(adult_by_age_education, aes(x = age, y = hsr)) +
geom_smooth(se = FALSE, size = 1) +
ylim(0,NA)
ggplot(adult_by_age_education, aes(x = age, y = hsr)) +
geom_smooth(size = 1) +
ylim(0,NA)
setwd('~/DataAnalyst/Projects/DataAnalystND_Project_6/')
data <- read.csv('pisa2012.csv')
ok
ggplot(data,aes(x = NC)) +
geom_bar()
library(ggplot2)
ggplot(data,aes(x = NC)) +
geom_bar()
ggplot(data,aes(y = NC)) +
geom_bar()
ggplot(data,aes(x = NC)) +
geom_bar()
ggplot(data,aes(x = CNT)) +
geom_bar()
ggplot(data,aes(x = CNT)) +
geom_bar() +
rotate_x
rotate_x = function(angle = 30) theme(axis.text.x = element_text(angle = angle, hjust = 1))
ggplot(data,aes(x = CNT)) +
geom_bar() +
rotate_x()
ggplot(data,aes(x = CNT)) +
geom_bar() +
rotate_x(60)
ggplot(data,aes(x = ST04Q01)) +
geom_bar() +
rotate_x(60)
ggplot(data,aes(x = ST04Q01)) +
geom_bar()
ggplot(data,aes(x = CNT)) +
geom_bar() +
rotate_x(60)
ggplot(data,aes(x = ST03Q01)) +
geom_bar()
ggplot(subset(data,ST03Q01<13),aes(x = ST03Q01)) +
geom_bar()
subset(data,ST03Q01>12)
nrow(subset(data,ST03Q01>12))
nrow(subset(data,ST03Q01>12))
ggplot(subset(data,ST03Q01>12),aes(ST03Q01)) +
geom_bar()
ggplot(data, aes(W_FSTUWT)) +
geom_bar()
ggplot(data, aes(WEALTH)) +
geom_bar()
ggplot(data, aes(ANCINTMAT)) +
geom_bar()
ggplot(data, aes(INTMAT)) +
geom_bar()
ggplot(data, aes(ANCINTMAT)) +
geom_bar()
ggplot(data, aes(INTMAT)) +
geom_bar()
ggplot(data, aes(ANCINTMAT)) +
geom_bar()
ggplot(data, aes(IMMIG)) +
geom_bar()
ggplot(data, aes(HOMEPOS)) +
geom_bar()
?gridExtra
library(gridExtra)
?gridExtra
library(gridExtra)
grid.arrange(p1,p2)
p1 <- ggplot(data, aes(WEALTH)) +
geom_bar(aes(WEALTH), color = blue) +
p2 <- ggplot(data, aes(HOMEPOS)) +
geom_bar()
grid.arrange(p1,p2)
p1 <- ggplot(data, aes(WEALTH)) +
geom_bar()
p2 <- ggplot(data, aes(HOMEPOS)) +
geom_bar()
grid.arrange(p1,p2)
ggplot(data, aes(ST19Q01)) +
geom_bar()
ggplot(data, aes(ST19Q01)) +
geom_bar() +
rotate_x()
?cor.test
?cor
cor(data$WEALTH, data$HOMEPOS,)
cor(data$WEALTH, data$HOMEPOS)
cor(data$WEALTH, data$HOMEPOS, use = 'complete.obs')
ggplot(data, aes(ST02Q01)) +
geom_bar() +
rotate_x
ggplot(data, aes(ST02Q01)) +
geom_bar()
ggplot(data, aes(ST01Q01)) +
geom_bar() +
rotate_x
ggplot(data, aes(ST01Q01)) +
geom_bar()
ggplot(subset(data,ST01Q01<25), aes(ST01Q01)) +
geom_bar()
ggplot(subset(data,ST01Q01>25), aes(ST01Q01)) +
geom_bar()
ggplot(data, aes(ESCS)) +
geom_bar()
ggplot(data, aes(STUDREL)) +
geom_bar()
cor(data$ESCS, data$HOMEPOS, use = 'complete.obs')
cor(data$WEALTH, data$HOMEPOS, use = 'complete.obs')
ggplot(data, aes(x = GRADE, fill=GENDER)) +
geom_bar()
ggplot(data, aes(x = GRADE, fill=ST04Q01)) +
geom_bar()
ggplot(data, aes(x = GRADE, fill=ST04Q01)) +
geom_bar(position='dodge')
ggplot(data,aes(x = ST04Q01)) +
geom_bar()
ggplot(data, aes(x = GRADE, fill=ST04Q01)) +
geom_bar(position='dodge')
ggplot(data, aes(x = CNT, fill = GRADE)) +
geom_bar()
ggplot(data, aes(x = CNT, fill = mean(GRADE))) +
geom_bar()
ggplot(data, aes(x = CNT, fill = sum(GRADE))) +
geom_bar()
mean(data$GRADE)
?mean
ggplot(data, aes(x = CNT, fill = mean(GRADE, na.rm = FALSE))) +
geom_bar()
mean(data$GRADE, na.rm = FALSE)
mean(data$GRADE, na.rm = TRUE)
ggplot(data, aes(x = CNT, fill = mean(GRADE, na.rm = TRUE))) +
geom_bar()
?stat_bin
ggplot(data, aes(x = CNT, fill = mean(GRADE, na.rm = TRUE))) +
geom_bar()
ggplot(data, aes(x = CNT, fill = mean(X, na.rm = TRUE))) +
geom_bar()
ggplot(data, aes(x = CNT, fill = mean(X))) +
geom_bar()
ggplot(data, aes(x = CNT)) +
geom_bar()
gdp <- read.csv('gdp.csv')
gdp$series
gdp <- subset(gdp,series = 'PPP (current international $)')
gdp.droplevels()
droplevels(gdp)
levels(gdp$series)
summary(gdp$series)
gdp <- read.csv('gdp.csv')
gdp <- subset(gdp,series = 'GDP per capita, PPP (current international $) ')
gdp <- read.csv('gdp.csv')
gdp <- subset(gdp,gdp$series = 'GDP per capita, PPP (current international $)')
gdp <- subset(gdp,gdp$series == 'GDP per capita, PPP (current international $)')
gdp = gdp[,c(1,5)]
View(gdp)
mean(data$GRADE, na.rm = TRUE)
ggplot(data, aes(x = CNT, y = mean(GRADE, na.rm = TRUE))) +
geom_bar(stat = 'identity')
library(reshape2)
?reshape2
?reshape
library(reshape2)
library(dplyr)
cnt_by_grade <- data %>%
group_by(CNT) %>%
summarize(GRADE = mean(GRADE))
View(cnt_by_grade)
View(subset(data,CNT='Vietnam')$GRADE)
View(subset(data,CNT='Vietnam'))
mean(subset(data,CNT='Vietnam')$GRADE
)
View(subset(data,CNT=='Vietnam'))
colnames(data)
mean(subset(data,CNT=='Vietnam')$GRADE)
mean(subset(data,CNT=='Vietnam')$GRADE, na.rm=TRUE)
cnt_by_grade <- data %>%
group_by(CNT) %>%
summarize(GRADE = mean(GRADE, na.rm = TRUE))
View(cnt_by_grade)
